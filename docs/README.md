
---

## 2025-07-17 專案現況與今日進展

### 條款偵測與前端優化
- 擴大 content.js 條款節點選取範圍，納入 h2~h6，並取消最短長度限制，確保所有條款都能被偵測。
- 條款內容直接用節點本身 innerText，避免只抓到巢狀 a 標籤內容。
- 側欄關閉時自動移除條款著色，並將著色顏色改為淡藍色（#e6f0fa）。

### 風險分析流程
- content.js 已改為呼叫 http://localhost:5000/analyze API，根據回傳的 risk_type 判斷風險。
- 判斷邏輯調整為「只有 risk_type 為『須注意』才標記為須注意，其餘一律標記為『一般資訊』」。
- 若 API 尚未回應，前端進度不會更新，全部分析完才會一次顯示。

### CORS 問題處理
- 在 tools/api_server.py 加入 flask_cors.CORS(app)，解決跨來源請求問題。

### 分析效能問題與未來方向
- 條款數量多時，全部送 GPT API 分析會導致分析時間極長（超過一小時）。
- 檢查 core/risk_analyzer.py、core/split_text.py，未發現無窮迴圈，主要瓶頸在於每條都需呼叫 GPT API。
- 「有沒有可能讓分析在10秒內就可以跑完？」的結論：只靠 GPT API 分析，10秒內完成多條款分析不現實。建議採用本地規則/關鍵字初篩，僅將疑似高風險條款送 GPT 分析，或提供用戶自選分析模式。
- 可考慮快取分析結果、分批非同步分析與即時顯示等方式提升體感速度。

---

本專案正持續優化條款偵測完整性、分析流程效能與前端互動體驗，明日將依據「10秒內分析可行性」結論進行優化規劃。
