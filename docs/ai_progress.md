# AI 合約條款風險分析工具

這是一個使用 GPT 模型的條款風險分析工具，幫助使用者自動檢測合約內容中可能須注意的條款。本工具支援中文與英文條文的判斷，並提供簡潔的 JSON 輸出與視覺化報告。

---

## ✅ 最新進度整理（更新：2025-06-26）

### 📌 今日進度總結（2025-06-26）

#### ✅ 快取機制擴充完成

* `test_risk_cases_runner_dual.py` 支援快取功能：以 `clause + language` 作為索引鍵，儲存於 `results_cache.json`
* 加入 CLI 參數：

  * `--no-cache`：不讀取／不寫入快取（每次都重新送 GPT）
  * `--limit N`：僅測試前 N 筆條文（黑白名單各取 N 筆）
* 測試結果顯示快取正確儲存並能跳過已分析條文

#### ✅ 黑白名單格式統一

* 所有測資補齊欄位：`type`, `reason`, `tags`, `language`
* 白名單補上空白 `reason` 欄位，避免欄位缺失
* 黑名單補齊缺漏欄位並保留既有 `reason` 資訊
* 新增工具：

  * `tools/fix_risk_format.py`
  * `tools/fix_whitelist_format.py`

#### ✅ 測試案例增量

* 使用 `--limit 10` 執行測試，成功擴充快取資料至 20 筆（黑白名單各 10 筆）
* 測試中共發現 3 筆分類錯誤，可據此調整測資或分析提示

---

## 🔜 下一階段任務

1. 🧪 建立 GPT 與測資 `type` 一致性驗證機制：

   * 新增 CLI 參數 `--check-type`
   * 檢查分析結果中的 `type` 與測資原本 `type` 是否一致
   * 顯示不一致條文、原始與 GPT 的 type 值
   * 忽略 `type = "待分類"` 的條文

2. 📊 新增 `--summary` 功能：

   * 統計條文總數、中英文比例
   * 顯示各類型（type）與風險等級（risk\_level）分布

3. 🔍 設計報告視覺化輸出格式（JSON）供 `report_template.html` 使用

   * 條文原文、風險標記、reason、type
   * 是否判斷正確（與標註比對）
   * 來源（黑或白名單）與語言

4. 🚀 擴充黑名單測資：

   * 條文數量目標達 100 條以上
   * 每筆補齊 `type`, `reason`, `tags`

---

## ✅ 現有功能

* 中英文條文語言自動判斷與清理
* GPT 分析模組 `risk_analyzer.py`
* 條文快取機制 `results_cache.json`
* 白名單與風險條文資料庫（格式統一）
* CLI 工具：分析、測試、語言與類型標註

---

開發進度持續穩定推進，歡迎團隊成員依據任務順序分工執行，確保每項功能完整測試與擴充。
