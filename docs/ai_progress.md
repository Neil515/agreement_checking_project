## 📌 專案名稱

AI 合約條款風險摘要工具助手（暫稱）

---

## ✅ 專案進度更新（2025-06-20）

### 🔍 本日進行項目紀錄

1. ✅ 初步串接 OpenAI GPT API，成功回傳 JSON 格式風險分析內容，並將模擬分析替換為實際分析流程。
2. ✅ 解決新版 OpenAI 套件錯誤（1.x 不支援舊版 API 調用），將 openai 降版本至 0.28.0 解決問題。
3. ✅ 加入 `prompt_template_en.txt`，並修正 prompt 調用邏輯，支援中英文提示。
4. ✅ 於 `risk_analyzer.py` 中新增偵錯輸出（印出 GPT 回傳原文），協助判斷錯誤類型與修正策略。
5. ✅ 大幅優化 `split_text.py` 英文分句邏輯，避開縮寫、網址、地名等誤切句。
6. ✅ 成功分析 Gowalla 條款全文，風險判斷顯著改善，地址與電話段落未再被誤判為風險。
7. ✅ 前端 HTML 報告支援 JSON 切換功能，可由下拉選單或按鈕切換顯示不同分析結果。
8. ✅ 修復選取框無效問題（checkbox），目前已可正確切換條文顯示篩選。

---

### 🧠 發現的問題與改善紀錄

* ❗ 模型對句子過度敏感，預設模擬模式導致所有句子都有風險等級（已切換為 GPT 分析，明顯改善）
* ❗ 若分句過細（例如：地點、電話成獨立句），容易誤導風險分析（已修正 `split_text.py`）
* ❗ 使用者容易忽略是否啟用 GPT，導致誤以為分析失效（已在錯誤提示中加入警告與提示）

---

### 🗂 今日輸出成果

* `outputs/full_agreement_analysis.json`：真實分析結果（已確認風險分類合理）
* `tests/full_agreement.txt`：Gowalla 條款全文測試用
* `prompt_template_en.txt`：新增英文版提示語模板

---

### 📝 備註與技術討論

* Gowalla 條款為真實歷史案例，但為開源教材使用，可能刻意包含多種風險範例，有助於驗證系統完整性。
* 若將 `split_text.py` 與 `risk_analyzer.py` 串接 prompt 設計策略（包含段落特徵），將能進一步降低誤判率。
* 分析速度瓶頸已明確定位於逐句呼叫 GPT，可納入明日優化項目（改為批次處理）。

---

欲查看分析結果，請打開 `report_template.html`，並透過內建 JSON 切換功能切換不同檔案。
