# AI 合約條款風險分析工具

這是一個使用 GPT 模型的條款風險分析工具，幫助使用者自動檢測合約內容中可能須注意的條款。本工具支援中文與英文條文的判斷，並提供簡潔的 JSON 輸出與視覺化報告。

---

## ✅ 最新進度整理（更新：2025-07-05）

### 📌 今日進度總結（2025-07-05）

#### ✅ 程式邏輯與資料優化

1. **風險分類處理邏輯優化**：

   * 新增 `standard_type_mapping.json` 作為主類別對照表（15 類）
   * 新增 `map_to_main_type()` 用以對應 GPT 自由輸出的類型關鍵字至主分類
   * 改寫 `risk_analyzer.py`，當 `type.zh` 有主分類對應時，自動補齊 `type_main.zh/en`

2. **穩定化 `type.en` 欄位**：

   * 若風險類型無對應於 `risk_type_mapping.json`，則 type.en fallback 為 `Unmapped`
   * 保證輸出格式一致，不再出現 type.en 欄位為中文或 null 的情況

3. **調整 `analyze_clause()` 輸出邏輯**：

   * 僅在 risk\_level 為「須注意」時才執行 `type` 與 `type_main` 推論
   * 縮短分析流程時間，提升解析效率

4. **回測分析流程結果穩定**：

   * 測試 `test_multi_clauses.py` 中多筆黑名單條文，type 與主分類皆準確對應
   * 多筆「一般資訊」條文被排除主分類處理，避免無效分析

---

## 🔜 下一階段任務（2025-07-06 起）

1. ✅ **測試條文切句準確性**：

   * 檢查目前的切句邏輯是否會：

     * 把完整條文誤切成碎片
     * 把不同邏輯的條文合併為一句
   * 建議挑選 2～3 份條款密集的範例檔案，觀察 `split_into_clauses()` 處理結果是否符合實務需求

2. ✅ **建立 clause\_id 與條號對應邏輯**：

   * 目前每條 clause 都會自動生成 `clause_id`（如 `C1`, `C2`），但與原始合約段落中的條號（如「第十條」、「1.2.3」）未對應
   * 建議新增一層 `source_ref` 欄位，例如：`"source_ref": "第十條 第3段"`，提升追溯性與可讀性

如需我協助開始進行這兩項任務，請隨時告訴我！
