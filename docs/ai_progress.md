## 2025-07-19 今日進度與內容整理

### 🎯 討論目標

* 針對「如何讓條款分析在10秒內完成」進行深入討論，並明確規劃可行的系統設計與開發任務。

---

### ✅ 討論結論

1. **單靠 GPT 分析全部條款無法達到10秒內完成**：

   * 多條款分析會造成線性時間累加，30 條以上可能超過 5～30 分鐘，使用者無法接受。

2. **可行方案為本地初篩 + 精準分析模式切換**：

   * 使用 Python 關鍵字或句型判斷進行快速標記
   * 僅將命中疑似風險的條款送 GPT 分析
   * 其餘條款直接標記為「一般資訊」

3. **新增快速分析模式（預設）**：

   * 執行本地規則初篩，1 秒內可完成
   * 非高風險條款不進入 GPT 判斷流程

4. **保留精準分析模式供法務使用**：

   * 分析可選「全部條款」或「手動貼上條款」
   * 使用者可主動控制分析時間與成本

5. **精準分析需採非同步執行，避免阻塞**：

   * 提交分析任務後回傳 task\_id
   * 任務完成後透過通知引導使用者回查

6. **設計查詢結果頁供回查分析內容**：

   * 任務完成後可透過 task\_id 查詢結果頁查看
   * 前端支援輪詢與狀態更新提示

---

### 🛠 系統改造任務規劃

#### 1. 建立快速分析規則模組

* 撰寫 `local_rule_filter(clause)`
* 建立高風險詞清單（初步 30\~50 組）
* 整合至 `risk_analyzer.py`

#### 2. 分析模式切換功能（前後端）

* 前端加上 radio button 或下拉選單讓用戶選擇模式
* `/analyze` API 接收 mode 參數
* 後端根據 mode 分流至快速/精準流程

#### 3. 精準分析的「部分條款」選項

* UI 增加文字框供貼上條文
* 僅傳送貼上條文進行分析

#### 4. 非同步任務背景處理

* 接收任務後立即回傳 task\_id
* 背景執行分析，儲存至 `outputs/pending_results/`

#### 5. 查詢頁與任務查詢 API

* 建立 `/result/<task_id>` 頁面
* 若尚未完成，顯示「分析中」並自動刷新
* 若已完成，呈現完整風險分析結果

#### 6. 分析完成通知機制

* 寄出 Email 或建立頁內提示
* 引導點擊「查看分析結果」按鈕返回查詢頁

---

### 🔍 總結

* 已從核心問題（速度過慢）推導出結構性解法與系統重構路徑
* 明日可從撰寫快速分析規則開始，逐步實作分析模式切換與非同步任務機制
